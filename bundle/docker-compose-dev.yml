version: '3'
services:
  react:
    container_name: ReactDevServer
    environment:
      WATCHPACK_POLLING: "true"
    build:
      context: .
      dockerfile: DockerfileDev
    working_dir: /app/cra
    volumes:
      - source: .
        target: "/app/cra"
        type: bind
      - "/app/cra/node_modules"
    expose:
      - ${CONTAINER_PORT}
    ports:
      - "0.0.0.0:${CONTAINER_PORT}:${HOST_PORT}"
  test:
    build:
      context: '.'
      dockerfile: DockerfileDev
    container_name: ReactTestExecutor
    working_dir: /app/cra
    volumes:
      - source: .
        target: "/app/cra"
        type: bind
        read_only: false
      - "/app/cra/node_modules"
    command: ['npm','run','test']
